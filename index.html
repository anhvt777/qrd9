<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <title>QR BIDV Custom</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <style>
    body{font-family:Arial, sans-serif; background:#f5f6fa; padding:20px}
    #preview{background:#fff; padding:20px; border-radius:20px; display:inline-block; box-shadow:0 4px 12px rgba(0,0,0,0.1)}
    canvas{display:block; margin:auto}
  </style>
</head>
<body>
  <h2>QR BIDV Custom</h2>
  <div id="preview"></div>
  <script>
    async function generateQRWithInfo() {
      const size = 400;
      // Tạo QR
      const temp = document.createElement('div');
      new QRCode(temp, {
        text: JSON.stringify({
          accountNumber:"123456789",
          accountName:"Nguyen Van A",
          bank:"BIDV",
          amount:"1000000"
        }),
        width: size,
        height: size,
        colorDark:"#000000",
        colorLight:"#ffffff",
        correctLevel: QRCode.CorrectLevel.H
      });
      await new Promise(r => setTimeout(r,100));
      const qrImg = temp.querySelector("img") || temp.querySelector("canvas");
      const dataUrl = qrImg.tagName.toLowerCase()==="img" ? qrImg.src : qrImg.toDataURL();
      const img = new Image();
      img.src = dataUrl;
      await img.decode();

      // Canvas lớn hơn để chứa text + bo góc
      const extraHeight = 140;
      const canvas = document.createElement("canvas");
      canvas.width = size + 40;
      canvas.height = size + extraHeight;
      const ctx = canvas.getContext("2d");

      // Nền trắng bo tròn
      roundRect(ctx, 0, 0, canvas.width, canvas.height, 20);
      ctx.fillStyle = "#ffffff";
      ctx.fill();

      // Vẽ QR
      ctx.drawImage(img, 20, 20, size, size);

      // Vẽ logo BIDV ở giữa QR
      const logo = new Image();
